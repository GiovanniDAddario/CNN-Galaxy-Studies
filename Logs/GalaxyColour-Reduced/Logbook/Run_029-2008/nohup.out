2020-08-20 16:02:53.393613: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-08-20 16:02:53.397816: I tensorflow/core/common_runtime/process_util.cc:69] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Normalisation check: 0.0 1.0
Training data shape:  (2460, 4, 100, 100)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 100, 98, 98)       3700      
_________________________________________________________________
dropout (Dropout)            (None, 100, 98, 98)       0         
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 100, 49, 49)       0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 200, 46, 46)       320200    
_________________________________________________________________
dropout_1 (Dropout)          (None, 200, 46, 46)       0         
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 200, 23, 23)       0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 200, 22, 22)       160200    
_________________________________________________________________
dropout_2 (Dropout)          (None, 200, 22, 22)       0         
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 200, 11, 11)       0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 200, 9, 9)         360200    
_________________________________________________________________
dropout_3 (Dropout)          (None, 200, 9, 9)         0         
_________________________________________________________________
flatten (Flatten)            (None, 16200)             0         
_________________________________________________________________
dense (Dense)                (None, 200)               3240200   
_________________________________________________________________
dropout_4 (Dropout)          (None, 200)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 402       
=================================================================
Total params: 4,084,902
Trainable params: 4,084,902
Non-trainable params: 0
_________________________________________________________________
None
callback created
Train on 2460 samples, validate on 284 samples
Epoch 1/10
 128/2460 [>.............................] - ETA: 1:32 - loss: 0.8134 - acc: 0.5078 256/2460 [==>...........................] - ETA: 1:05 - loss: 0.7792 - acc: 0.5625 384/2460 [===>..........................] - ETA: 54s - loss: 0.7735 - acc: 0.5703  512/2460 [=====>........................] - ETA: 48s - loss: 0.7739 - acc: 0.5527 640/2460 [======>.......................] - ETA: 43s - loss: 0.7782 - acc: 0.5484 768/2460 [========>.....................] - ETA: 38s - loss: 0.7685 - acc: 0.5469 896/2460 [=========>....................] - ETA: 35s - loss: 0.7583 - acc: 0.54581024/2460 [===========>..................] - ETA: 31s - loss: 0.7575 - acc: 0.54881152/2460 [=============>................] - ETA: 28s - loss: 0.7631 - acc: 0.54861280/2460 [==============>...............] - ETA: 25s - loss: 0.7626 - acc: 0.54691408/2460 [================>.............] - ETA: 22s - loss: 0.7590 - acc: 0.54901536/2460 [=================>............] - ETA: 19s - loss: 0.7555 - acc: 0.54821664/2460 [===================>..........] - ETA: 16s - loss: 0.7521 - acc: 0.54991792/2460 [====================>.........] - ETA: 13s - loss: 0.7498 - acc: 0.55131920/2460 [======================>.......] - ETA: 11s - loss: 0.7509 - acc: 0.54642048/2460 [=======================>......] - ETA: 8s - loss: 0.7501 - acc: 0.5439 2176/2460 [=========================>....] - ETA: 5s - loss: 0.7496 - acc: 0.53952304/2460 [===========================>..] - ETA: 3s - loss: 0.7461 - acc: 0.53822432/2460 [============================>.] - ETA: 0s - loss: 0.7445 - acc: 0.53622460/2460 [==============================] - 51s 21ms/step - loss: 0.7445 - acc: 0.5354 - val_loss: 0.6934 - val_acc: 0.3873

Epoch 00001: saving model to ./checkpoint/cp.ckpt
Epoch 2/10
 128/2460 [>.............................] - ETA: 43s - loss: 0.6983 - acc: 0.5547 256/2460 [==>...........................] - ETA: 41s - loss: 0.6982 - acc: 0.5234 384/2460 [===>..........................] - ETA: 38s - loss: 0.6971 - acc: 0.5391 512/2460 [=====>........................] - ETA: 36s - loss: 0.6906 - acc: 0.5469 640/2460 [======>.......................] - ETA: 33s - loss: 0.6978 - acc: 0.5406 768/2460 [========>.....................] - ETA: 31s - loss: 0.6985 - acc: 0.5404 896/2460 [=========>....................] - ETA: 29s - loss: 0.6987 - acc: 0.53911024/2460 [===========>..................] - ETA: 26s - loss: 0.7017 - acc: 0.52051152/2460 [=============>................] - ETA: 24s - loss: 0.7047 - acc: 0.51131280/2460 [==============>...............] - ETA: 21s - loss: 0.7052 - acc: 0.51411408/2460 [================>.............] - ETA: 19s - loss: 0.7039 - acc: 0.51631536/2460 [=================>............] - ETA: 17s - loss: 0.7019 - acc: 0.51891664/2460 [===================>..........] - ETA: 14s - loss: 0.7018 - acc: 0.52221792/2460 [====================>.........] - ETA: 12s - loss: 0.7012 - acc: 0.52291920/2460 [======================>.......] - ETA: 10s - loss: 0.7004 - acc: 0.52452048/2460 [=======================>......] - ETA: 7s - loss: 0.6993 - acc: 0.5288 2176/2460 [=========================>....] - ETA: 5s - loss: 0.6984 - acc: 0.52942304/2460 [===========================>..] - ETA: 2s - loss: 0.6980 - acc: 0.53172432/2460 [============================>.] - ETA: 0s - loss: 0.6984 - acc: 0.52922460/2460 [==============================] - 48s 19ms/step - loss: 0.6982 - acc: 0.5293 - val_loss: 0.6917 - val_acc: 0.6197

Epoch 00002: saving model to ./checkpoint/cp.ckpt
Epoch 3/10
 128/2460 [>.............................] - ETA: 42s - loss: 0.6832 - acc: 0.5859 256/2460 [==>...........................] - ETA: 40s - loss: 0.6947 - acc: 0.5312 384/2460 [===>..........................] - ETA: 38s - loss: 0.6919 - acc: 0.5495 512/2460 [=====>........................] - ETA: 35s - loss: 0.6922 - acc: 0.5352 640/2460 [======>.......................] - ETA: 33s - loss: 0.6905 - acc: 0.5391 768/2460 [========>.....................] - ETA: 31s - loss: 0.6924 - acc: 0.5352 896/2460 [=========>....................] - ETA: 28s - loss: 0.6932 - acc: 0.52341024/2460 [===========>..................] - ETA: 26s - loss: 0.6924 - acc: 0.53221152/2460 [=============>................] - ETA: 24s - loss: 0.6920 - acc: 0.53121280/2460 [==============>...............] - ETA: 21s - loss: 0.6923 - acc: 0.52811408/2460 [================>.............] - ETA: 19s - loss: 0.6940 - acc: 0.52561536/2460 [=================>............] - ETA: 17s - loss: 0.6952 - acc: 0.52341664/2460 [===================>..........] - ETA: 14s - loss: 0.6937 - acc: 0.52821792/2460 [====================>.........] - ETA: 12s - loss: 0.6933 - acc: 0.53291920/2460 [======================>.......] - ETA: 9s - loss: 0.6911 - acc: 0.5359 2048/2460 [=======================>......] - ETA: 7s - loss: 0.6906 - acc: 0.53372176/2460 [=========================>....] - ETA: 5s - loss: 0.6895 - acc: 0.53812304/2460 [===========================>..] - ETA: 2s - loss: 0.6908 - acc: 0.53472432/2460 [============================>.] - ETA: 0s - loss: 0.6907 - acc: 0.53582460/2460 [==============================] - 47s 19ms/step - loss: 0.6906 - acc: 0.5370 - val_loss: 0.6903 - val_acc: 0.6197

Epoch 00003: saving model to ./checkpoint/cp.ckpt
Epoch 4/10
 128/2460 [>.............................] - ETA: 44s - loss: 0.6935 - acc: 0.4844 256/2460 [==>...........................] - ETA: 41s - loss: 0.6870 - acc: 0.5156 384/2460 [===>..........................] - ETA: 38s - loss: 0.6810 - acc: 0.5312 512/2460 [=====>........................] - ETA: 36s - loss: 0.6829 - acc: 0.5312 640/2460 [======>.......................] - ETA: 34s - loss: 0.6846 - acc: 0.5297 768/2460 [========>.....................] - ETA: 31s - loss: 0.6848 - acc: 0.5352 896/2460 [=========>....................] - ETA: 29s - loss: 0.6835 - acc: 0.54801024/2460 [===========>..................] - ETA: 27s - loss: 0.6838 - acc: 0.55761152/2460 [=============>................] - ETA: 24s - loss: 0.6839 - acc: 0.55991280/2460 [==============>...............] - ETA: 22s - loss: 0.6850 - acc: 0.55781408/2460 [================>.............] - ETA: 19s - loss: 0.6845 - acc: 0.55681536/2460 [=================>............] - ETA: 17s - loss: 0.6830 - acc: 0.56121664/2460 [===================>..........] - ETA: 15s - loss: 0.6821 - acc: 0.56551792/2460 [====================>.........] - ETA: 12s - loss: 0.6830 - acc: 0.56641920/2460 [======================>.......] - ETA: 10s - loss: 0.6828 - acc: 0.56612048/2460 [=======================>......] - ETA: 7s - loss: 0.6839 - acc: 0.5605 2176/2460 [=========================>....] - ETA: 5s - loss: 0.6844 - acc: 0.56162304/2460 [===========================>..] - ETA: 2s - loss: 0.6837 - acc: 0.56642432/2460 [============================>.] - ETA: 0s - loss: 0.6835 - acc: 0.56662460/2460 [==============================] - 48s 20ms/step - loss: 0.6834 - acc: 0.5671 - val_loss: 0.6886 - val_acc: 0.6197

Epoch 00004: saving model to ./checkpoint/cp.ckpt
Epoch 5/10
 128/2460 [>.............................] - ETA: 43s - loss: 0.6836 - acc: 0.5469 256/2460 [==>...........................] - ETA: 41s - loss: 0.6849 - acc: 0.5664 384/2460 [===>..........................] - ETA: 38s - loss: 0.6908 - acc: 0.5443 512/2460 [=====>........................] - ETA: 36s - loss: 0.6864 - acc: 0.5586 640/2460 [======>.......................] - ETA: 33s - loss: 0.6838 - acc: 0.5766 768/2460 [========>.....................] - ETA: 31s - loss: 0.6828 - acc: 0.5885 896/2460 [=========>....................] - ETA: 29s - loss: 0.6806 - acc: 0.59261024/2460 [===========>..................] - ETA: 26s - loss: 0.6843 - acc: 0.58501152/2460 [=============>................] - ETA: 24s - loss: 0.6848 - acc: 0.57991280/2460 [==============>...............] - ETA: 21s - loss: 0.6838 - acc: 0.58591408/2460 [================>.............] - ETA: 19s - loss: 0.6828 - acc: 0.58381536/2460 [=================>............] - ETA: 17s - loss: 0.6814 - acc: 0.58531664/2460 [===================>..........] - ETA: 14s - loss: 0.6812 - acc: 0.58591792/2460 [====================>.........] - ETA: 12s - loss: 0.6813 - acc: 0.58541920/2460 [======================>.......] - ETA: 10s - loss: 0.6826 - acc: 0.58022048/2460 [=======================>......] - ETA: 7s - loss: 0.6835 - acc: 0.5820 2176/2460 [=========================>....] - ETA: 5s - loss: 0.6825 - acc: 0.58132304/2460 [===========================>..] - ETA: 2s - loss: 0.6827 - acc: 0.57942432/2460 [============================>.] - ETA: 0s - loss: 0.6828 - acc: 0.57772460/2460 [==============================] - 47s 19ms/step - loss: 0.6824 - acc: 0.5780 - val_loss: 0.6870 - val_acc: 0.6197

Epoch 00005: saving model to ./checkpoint/cp.ckpt
Epoch 6/10
 128/2460 [>.............................] - ETA: 43s - loss: 0.6788 - acc: 0.5781 256/2460 [==>...........................] - ETA: 40s - loss: 0.6799 - acc: 0.5586 384/2460 [===>..........................] - ETA: 38s - loss: 0.6778 - acc: 0.5521 512/2460 [=====>........................] - ETA: 35s - loss: 0.6745 - acc: 0.5586 640/2460 [======>.......................] - ETA: 33s - loss: 0.6769 - acc: 0.5516 768/2460 [========>.....................] - ETA: 31s - loss: 0.6766 - acc: 0.5560 896/2460 [=========>....................] - ETA: 28s - loss: 0.6789 - acc: 0.55921024/2460 [===========>..................] - ETA: 26s - loss: 0.6782 - acc: 0.56051152/2460 [=============>................] - ETA: 23s - loss: 0.6769 - acc: 0.56421280/2460 [==============>...............] - ETA: 21s - loss: 0.6775 - acc: 0.55781408/2460 [================>.............] - ETA: 19s - loss: 0.6765 - acc: 0.56181536/2460 [=================>............] - ETA: 17s - loss: 0.6764 - acc: 0.56381664/2460 [===================>..........] - ETA: 14s - loss: 0.6774 - acc: 0.55831792/2460 [====================>.........] - ETA: 12s - loss: 0.6795 - acc: 0.55641920/2460 [======================>.......] - ETA: 9s - loss: 0.6801 - acc: 0.5578 2048/2460 [=======================>......] - ETA: 7s - loss: 0.6806 - acc: 0.55962176/2460 [=========================>....] - ETA: 5s - loss: 0.6793 - acc: 0.56342304/2460 [===========================>..] - ETA: 2s - loss: 0.6799 - acc: 0.56422432/2460 [============================>.] - ETA: 0s - loss: 0.6801 - acc: 0.56502460/2460 [==============================] - 47s 19ms/step - loss: 0.6807 - acc: 0.5642 - val_loss: 0.6848 - val_acc: 0.6197

Epoch 00006: saving model to ./checkpoint/cp.ckpt
Epoch 7/10
 128/2460 [>.............................] - ETA: 44s - loss: 0.6718 - acc: 0.6172 256/2460 [==>...........................] - ETA: 42s - loss: 0.6672 - acc: 0.6016 384/2460 [===>..........................] - ETA: 39s - loss: 0.6648 - acc: 0.5990 512/2460 [=====>........................] - ETA: 37s - loss: 0.6662 - acc: 0.6055 640/2460 [======>.......................] - ETA: 34s - loss: 0.6670 - acc: 0.5969 768/2460 [========>.....................] - ETA: 32s - loss: 0.6693 - acc: 0.5807 896/2460 [=========>....................] - ETA: 29s - loss: 0.6726 - acc: 0.57481024/2460 [===========>..................] - ETA: 27s - loss: 0.6701 - acc: 0.57521152/2460 [=============>................] - ETA: 24s - loss: 0.6702 - acc: 0.58071280/2460 [==============>...............] - ETA: 22s - loss: 0.6701 - acc: 0.58201408/2460 [================>.............] - ETA: 19s - loss: 0.6715 - acc: 0.57881536/2460 [=================>............] - ETA: 17s - loss: 0.6729 - acc: 0.58141664/2460 [===================>..........] - ETA: 14s - loss: 0.6738 - acc: 0.58051792/2460 [====================>.........] - ETA: 12s - loss: 0.6752 - acc: 0.57251920/2460 [======================>.......] - ETA: 10s - loss: 0.6770 - acc: 0.57192048/2460 [=======================>......] - ETA: 7s - loss: 0.6758 - acc: 0.5757 2176/2460 [=========================>....] - ETA: 5s - loss: 0.6762 - acc: 0.57312304/2460 [===========================>..] - ETA: 2s - loss: 0.6765 - acc: 0.57122432/2460 [============================>.] - ETA: 0s - loss: 0.6773 - acc: 0.56782460/2460 [==============================] - 48s 20ms/step - loss: 0.6771 - acc: 0.5675 - val_loss: 0.6832 - val_acc: 0.6197

Epoch 00007: saving model to ./checkpoint/cp.ckpt
Epoch 8/10
 128/2460 [>.............................] - ETA: 43s - loss: 0.6798 - acc: 0.5625 256/2460 [==>...........................] - ETA: 40s - loss: 0.6859 - acc: 0.5352 384/2460 [===>..........................] - ETA: 38s - loss: 0.6882 - acc: 0.5286 512/2460 [=====>........................] - ETA: 35s - loss: 0.6828 - acc: 0.5391 640/2460 [======>.......................] - ETA: 33s - loss: 0.6784 - acc: 0.5563 768/2460 [========>.....................] - ETA: 31s - loss: 0.6746 - acc: 0.5677 896/2460 [=========>....................] - ETA: 28s - loss: 0.6726 - acc: 0.56581024/2460 [===========>..................] - ETA: 26s - loss: 0.6737 - acc: 0.56931152/2460 [=============>................] - ETA: 24s - loss: 0.6744 - acc: 0.56421280/2460 [==============>...............] - ETA: 21s - loss: 0.6738 - acc: 0.56331408/2460 [================>.............] - ETA: 19s - loss: 0.6732 - acc: 0.56531536/2460 [=================>............] - ETA: 17s - loss: 0.6729 - acc: 0.56581664/2460 [===================>..........] - ETA: 14s - loss: 0.6704 - acc: 0.56671792/2460 [====================>.........] - ETA: 12s - loss: 0.6707 - acc: 0.57141920/2460 [======================>.......] - ETA: 10s - loss: 0.6720 - acc: 0.57032048/2460 [=======================>......] - ETA: 7s - loss: 0.6724 - acc: 0.5693 2176/2460 [=========================>....] - ETA: 5s - loss: 0.6707 - acc: 0.57172304/2460 [===========================>..] - ETA: 2s - loss: 0.6723 - acc: 0.56902432/2460 [============================>.] - ETA: 0s - loss: 0.6743 - acc: 0.56502460/2460 [==============================] - 47s 19ms/step - loss: 0.6735 - acc: 0.5659 - val_loss: 0.6809 - val_acc: 0.6197

Epoch 00008: saving model to ./checkpoint/cp.ckpt
Epoch 9/10
 128/2460 [>.............................] - ETA: 44s - loss: 0.6547 - acc: 0.6562 256/2460 [==>...........................] - ETA: 41s - loss: 0.6630 - acc: 0.6133 384/2460 [===>..........................] - ETA: 39s - loss: 0.6732 - acc: 0.5885 512/2460 [=====>........................] - ETA: 36s - loss: 0.6732 - acc: 0.5723 640/2460 [======>.......................] - ETA: 33s - loss: 0.6699 - acc: 0.5703 768/2460 [========>.....................] - ETA: 31s - loss: 0.6707 - acc: 0.5690 896/2460 [=========>....................] - ETA: 29s - loss: 0.6701 - acc: 0.57141024/2460 [===========>..................] - ETA: 26s - loss: 0.6763 - acc: 0.56251152/2460 [=============>................] - ETA: 24s - loss: 0.6744 - acc: 0.56771280/2460 [==============>...............] - ETA: 21s - loss: 0.6798 - acc: 0.55861408/2460 [================>.............] - ETA: 19s - loss: 0.6768 - acc: 0.56611536/2460 [=================>............] - ETA: 17s - loss: 0.6761 - acc: 0.56451664/2460 [===================>..........] - ETA: 14s - loss: 0.6733 - acc: 0.56911792/2460 [====================>.........] - ETA: 12s - loss: 0.6716 - acc: 0.57201920/2460 [======================>.......] - ETA: 10s - loss: 0.6722 - acc: 0.57142048/2460 [=======================>......] - ETA: 7s - loss: 0.6727 - acc: 0.5684 2176/2460 [=========================>....] - ETA: 5s - loss: 0.6726 - acc: 0.56942304/2460 [===========================>..] - ETA: 2s - loss: 0.6726 - acc: 0.56862432/2460 [============================>.] - ETA: 0s - loss: 0.6714 - acc: 0.57072460/2460 [==============================] - 47s 19ms/step - loss: 0.6720 - acc: 0.5675 - val_loss: 0.6790 - val_acc: 0.6197

Epoch 00009: saving model to ./checkpoint/cp.ckpt
Epoch 10/10
 128/2460 [>.............................] - ETA: 43s - loss: 0.6718 - acc: 0.6094 256/2460 [==>...........................] - ETA: 40s - loss: 0.6757 - acc: 0.5820 384/2460 [===>..........................] - ETA: 38s - loss: 0.6796 - acc: 0.5833 512/2460 [=====>........................] - ETA: 35s - loss: 0.6757 - acc: 0.5859 640/2460 [======>.......................] - ETA: 33s - loss: 0.6746 - acc: 0.5828 768/2460 [========>.....................] - ETA: 31s - loss: 0.6745 - acc: 0.5742 896/2460 [=========>....................] - ETA: 28s - loss: 0.6755 - acc: 0.56921024/2460 [===========>..................] - ETA: 26s - loss: 0.6733 - acc: 0.57231152/2460 [=============>................] - ETA: 24s - loss: 0.6691 - acc: 0.58161280/2460 [==============>...............] - ETA: 21s - loss: 0.6712 - acc: 0.56951408/2460 [================>.............] - ETA: 19s - loss: 0.6723 - acc: 0.56821536/2460 [=================>............] - ETA: 17s - loss: 0.6701 - acc: 0.57621664/2460 [===================>..........] - ETA: 14s - loss: 0.6713 - acc: 0.57691792/2460 [====================>.........] - ETA: 12s - loss: 0.6708 - acc: 0.57481920/2460 [======================>.......] - ETA: 10s - loss: 0.6712 - acc: 0.57452048/2460 [=======================>......] - ETA: 7s - loss: 0.6723 - acc: 0.5723 2176/2460 [=========================>....] - ETA: 5s - loss: 0.6722 - acc: 0.56892304/2460 [===========================>..] - ETA: 2s - loss: 0.6708 - acc: 0.57252432/2460 [============================>.] - ETA: 0s - loss: 0.6693 - acc: 0.57322460/2460 [==============================] - 48s 19ms/step - loss: 0.6697 - acc: 0.5728 - val_loss: 0.6773 - val_acc: 0.6197
training.py:42: VisibleDeprecationWarning: Reading unicode strings without specifying the encoding argument is deprecated. Set the encoding, use None for the system default.
  skip_header=1, dtype=None)
training.py:56: VisibleDeprecationWarning: Reading unicode strings without specifying the encoding argument is deprecated. Set the encoding, use None for the system default.
  val_label_data = np.genfromtxt(val_label_file,  delimiter=',', skip_header=1, dtype=None)

Epoch 00010: saving model to ./checkpoint/cp.ckpt
model trained
Accuracy  [0.5353658535131594, 0.5292682924890906, 0.536991869821781, 0.5670731708286254, 0.578048780584723, 0.5642276422764227, 0.5674796746029117, 0.5658536584396673, 0.5674796749421251, 0.5727642274484401]
Val accuracy:  [0.3873239428224698, 0.6197183090196529, 0.6197183090196529, 0.6197183090196529, 0.6197183090196529, 0.6197183090196529, 0.6197183090196529, 0.6197183090196529, 0.6197183090196529, 0.6197183090196529]

Training: elapsed 539.312 seconds.
Traceback (most recent call last):
  File "training.py", line 19, in <module>
    from cnn import cnn_model
  File "/net/lnx0/scratch/gxd743/sdss/snapnum_099/CNN/CentralVsSatelliteGalaxy-Reduced/Logbook/Run_029-2008/cnn.py", line 12, in <module>
    file_shape = np.shape(fits.getdata(train_data_dir + '/' + os.listdir(train_data_dir)[0]))
FileNotFoundError: [Errno 2] No such file or directory: './train_dir'
